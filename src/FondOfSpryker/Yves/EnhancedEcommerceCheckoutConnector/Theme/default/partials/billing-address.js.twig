var datalayer = {
    event: "genericEvent",
    eventCategory: "ecommerce",
    eventAction: "checkout",
    eventLabel: "1",
    ecommerce: {
        checkout: {
            actionField: {
                step: "1"
            },
            products: [
                {% for product in enhancedEcommerce.products %}
                {
                    id: '{{ product.id }}',
                    name: '{{ product.name }}',
                    variant: '{{ product.variant }}',
                    brand: '{{ product.brand }}',
                    dimension10: '{{ product.dimension10 }}',
                    quantity: {{ product.quantity }},
                    {% if product.coupon not empty %}coupon: '{{ product.coupon }}',{% endif %}
                    price: '{{ product.price }}'
                }{% if loop.last != true %},{% endif %}
                {% endfor %}
            ]
        }
    }
};

var datalayerGA4 = {
    event: "begin_checkout",
    ecommerce: {
        items: [
            {% for product in enhancedEcommerce.products %}
            {
                item_name: '{{ product.name }}',
                item_id: '{{ product.id }}',
                item_brand: '{{ product.brand }}',
                item_variant: '{{ product.variant }}',
                quantity: {{ product.quantity }},
                {% if product.coupon not empty %}coupon: '{{ product.coupon }}',{% endif %}
                dimension10: '{{ product.dimension10 }}',
                price: '{{ product.price }}'
                {% if loop.last != true %},{% endif %}
            {% endfor %}]
    }
};

window.dataLayer = window.dataLayer || [];
window.dataLayer.push(datalayer);
dataLayer.push({ ecommerce: null });
window.dataLayer.push(datalayerGA4);
